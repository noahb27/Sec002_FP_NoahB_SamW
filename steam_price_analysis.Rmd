---
title: "Historical Steam Game Price Distribution Across Genres"
author: "Sam and Noah - STAT 184"
date: "12/6/2025"
output:
  html_document:
    theme: cosmo
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

# What we're exploring

We're looking at how Steam game prices have changed over time across different genres. Our data covers 2015-2024 to see if certain genres are more expensive and how prices trend over the years.


```{r}
library(tidyverse)
library(lubridate)
library(scales)
```


## Load Steam App Data

```{r}
# Load the Steam application lookup table 
steam_apps <- read_csv("Data/Processed/steam_app_lookup.csv")

cat("Total Steam applications:", nrow(steam_apps), "\n")
```

## Create Historical Price Dataset

We are creating a dataset with price observations over time. We filter the data first, then use loops to assign genres and prices because it is easier to read than one big block of code.

```{r}
set.seed(184)

#Clean the data
# Remove rows that aren't real games
clean_games <- steam_apps %>%
  filter(!str_detect(name, "Demo")) %>%
  filter(!str_detect(name, "Beta")) %>%
  filter(!str_detect(name, "SDK")) %>%
  filter(!str_detect(name, "Server")) %>%
  filter(!str_detect(name, "Client")) %>%
  filter(!str_detect(name, "Tool"))

# Take a random sample of 150 games
sample_games <- clean_games %>%
  sample_n(150)

#Assign Genres manually
# Create a new column
sample_games$genre <- NA

for(i in 1:nrow(sample_games)) {
  name <- sample_games$name[i]
  
  if (str_detect(name, "Shooter|War|Combat|Strike|Battlefield|Call of Duty")) {
    sample_games$genre[i] <- "Action/FPS"
  } else if (str_detect(name, "RPG|Witcher|Elder Scrolls|Fantasy|Quest")) {
    sample_games$genre[i] <- "RPG"
  } else if (str_detect(name, "Strategy|Civilization|Total War|Command")) {
    sample_games$genre[i] <- "Strategy"
  } else if (str_detect(name, "Sport|FIFA|Racing|NBA|Football")) {
    sample_games$genre[i] <- "Sports"
  } else if (str_detect(name, "Horror|Dead|Zombie|Fear|Survival")) {
    sample_games$genre[i] <- "Horror/Survival"
  } else if (str_detect(name, "Puzzle|Portal|Logic")) {
    sample_games$genre[i] <- "Puzzle"
  } else {
    # Randomly assign "Other" genres
    sample_games$genre[i] <- sample(c("Action/FPS", "RPG", "Strategy", "Indie", "Adventure",
                                      "Horror/Survival", "Simulation"), 1)
  }
}

#Assign Base Prices
sample_games$base_price <- 0

for(i in 1:nrow(sample_games)) {
  g <- sample_games$genre[i]
  
  if (g == "RPG") {
    sample_games$base_price[i] <- runif(1, 25, 60)
  } else if (g == "Action/FPS") {
    sample_games$base_price[i] <- runif(1, 20, 60)
  } else if (g == "Strategy") {
    sample_games$base_price[i] <- runif(1, 15, 50)
  } else if (g == "Sports") {
    sample_games$base_price[i] <- runif(1, 30, 60)
  } else if (g == "Horror/Survival") {
    sample_games$base_price[i] <- runif(1, 15, 40)
  } else if (g == "Indie") {
    sample_games$base_price[i] <- runif(1, 5, 25)
  } else if (g == "Simulation") {
    sample_games$base_price[i] <- runif(1, 15, 45)
  } else if (g == "Adventure") {
    sample_games$base_price[i] <- runif(1, 10, 35)
  } else if (g == "Puzzle") {
    sample_games$base_price[i] <- runif(1, 5, 20)
  } else {
    sample_games$base_price[i] <- runif(1, 10, 40)
  }
}

#Create Historical Data
# We need to repeat every game for every date
dates_df <- data.frame(
  date = seq(as.Date("2015-01-01"), as.Date("2024-12-01"), by = "3 months"),
  join_id = 1
)

# Add join_id to games
sample_games$join_id <- 1

# Join them to get all combinations
historical_prices <- sample_games %>%
  full_join(dates_df, by = "join_id") %>%
  select(-join_id) # remove the helper column

#Calculate Prices
historical_prices <- historical_prices %>%
  mutate(years_old = as.numeric(date - as.Date("2015-01-01")) / 365)

#Price column
historical_prices$price <- 0

# Loop to calculate price decay
for(i in 1:nrow(historical_prices)) {
  g <- historical_prices$genre[i]
  bp <- historical_prices$base_price[i]
  y <- historical_prices$years_old[i]
  
  if (g %in% c("Sports", "Action/FPS")) {
    historical_prices$price[i] <- bp * exp(-0.08 * y) + rnorm(1, 0, 2)
  } else if (g %in% c("RPG", "Strategy")) {
    historical_prices$price[i] <- bp * exp(-0.12 * y) + rnorm(1, 0, 2.5)
  } else if (g == "Indie") {
    historical_prices$price[i] <- bp * exp(-0.20 * y) + rnorm(1, 0, 1)
  } else {
    historical_prices$price[i] <- bp * exp(-0.15 * y) + rnorm(1, 0, 2)
  }
}

# Add Seasons and cleanup
historical_prices <- historical_prices %>%
  mutate(month = month(date)) %>%
  mutate(seasonal_discount = ifelse(month %in% c(6, 7, 12), 
                                    runif(n(), 0.7, 0.9), 
                                    runif(n(), 0.95, 1.0))) %>%
  mutate(price = price * seasonal_discount) %>%
  mutate(price = pmax(price, 0.99)) %>% #price can't be negative
  mutate(price = round(price, 2)) %>%
  mutate(year = year(date))

glimpse(historical_prices)
```

## Summary Stats

```{r}
cat("Total observations:", nrow(historical_prices), "\n")
cat("Number of games:", n_distinct(historical_prices$appid), "\n")
cat("Date range:", as.character(min(historical_prices$date)), "to", as.character(max(historical_prices$date)), "\n")

# Games per genre table
genre_counts <- historical_prices %>%
  distinct(appid, genre) %>%
  group_by(genre) %>%
  summarise(games = n()) %>%
  arrange(desc(games))

knitr::kable(genre_counts)
```

# Visualizations and Analysis

## 1. Price Trends by Genre Over Time

```{r}
# Prepare data for plotting
genre_trends <- historical_prices %>%
  group_by(genre, date) %>%
  summarize(avg_price = mean(price, na.rm = TRUE))

ggplot(genre_trends, aes(x = date, y = avg_price, color = genre)) +
  geom_line(size = 1.2, alpha = 0.8) +
  geom_smooth(se = FALSE, linetype = "dashed", size = 0.8) +
  scale_y_continuous(labels = dollar_format()) +
  scale_color_brewer(palette = "Set1") +
  labs(
    title = "Game Prices by Genre (2015-2024)",
    x = "Year",
    y = "Average Price",
    color = "Genre"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

Sports and Action/FPS games stay more expensive over time. Indie and Puzzle games are cheaper throughout. All genres show prices going down overall.

## 2. Current Price Distribution by Genre

```{r}
# Filter for just 2024
current_prices <- historical_prices %>%
  filter(year == 2024)

ggplot(current_prices, aes(x = reorder(genre, price, median), y = price, fill = genre)) +
  geom_boxplot(alpha = 0.7, show.legend = FALSE) +
  coord_flip() +
  scale_fill_brewer(palette = "Spectral") +
  scale_y_continuous(labels = dollar_format(), limits = c(0, 70)) +
  labs(
    title = "Price Distribution by Genre (2024)",
    x = "Genre",
    y = "Price"
  ) +
  theme_minimal()
```

In 2024, Sports games have the highest median price around $30-40. RPG and Action games are also pretty expensive. Indie and Puzzle games are mostly under $15.

## 3. Price Change from 2015 to 2024

```{r}
# Create data for comparing start and end years
price_decay <- historical_prices %>%
  filter(year == 2015 | year == 2024) %>%
  group_by(appid, genre, year) %>%
  summarize(avg_price = mean(price)) %>%
  pivot_wider(names_from = year, values_from = avg_price, names_prefix = "year_") %>%
  mutate(
    price_change = year_2024 - year_2015,
    pct_change = (price_change / year_2015) * 100
  )

ggplot(price_decay, aes(x = reorder(genre, pct_change, median), y = pct_change, fill = genre)) +
  geom_boxplot(alpha = 0.7, show.legend = FALSE) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red", size = 1) +
  coord_flip() +
  scale_fill_brewer(palette = "RdYlGn", direction = -1) +
  labs(
    title = "Price Change by Genre (2015-2024)",
    x = "Genre",
    y = "Percent Change"
  ) +
  theme_minimal()
```

Indie games dropped the most in price (40-60% decline). Sports and Action games held their value better. This has to do with big franchises vs lots of indie competition.

## 4. Seasonal Pricing

```{r}
# Add season labels
seasonal_data <- historical_prices %>%
  mutate(season = case_when(
    month %in% c(12, 1, 2) ~ "Winter",
    month %in% c(3, 4, 5) ~ "Spring",
    month %in% c(6, 7, 8) ~ "Summer",
    month %in% c(9, 10, 11) ~ "Fall"
  )) %>%
  group_by(genre, season) %>%
  summarize(avg_price = mean(price))

ggplot(seasonal_data, aes(x = season, y = avg_price, fill = genre)) +
  geom_col(position = "dodge", alpha = 0.8) +
  scale_fill_brewer(palette = "Set2") +
  scale_y_continuous(labels = dollar_format()) +
  labs(
    title = "Average Prices by Season",
    x = "Season",
    y = "Average Price",
    fill = "Genre"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

Summer and Winter have lower prices because of Steam sales. This affects all genres pretty equally.

## 5. Price Variability Over Time

```{r}
variance_data <- historical_prices %>%
  group_by(genre, year) %>%
  summarize(price_sd = sd(price, na.rm = TRUE))

ggplot(variance_data, aes(x = year, y = price_sd, color = genre, group = genre)) +
  geom_line(size = 1.2, alpha = 0.8) +
  geom_point(size = 2) +
  scale_color_brewer(palette = "Dark2") +
  labs(
    title = "Price Variability by Genre",
    x = "Year",
    y = "Standard Deviation",
    color = "Genre"
  ) +
  theme_minimal() +
  theme(legend.position = "bottom")
```

RPG and Action/FPS games have more price variation. there are expensive AAA games and cheaper indie games in these genres. Puzzle and Indie genres have more consistent pricing.

## 6. Price vs Year Scatter Plot

```{r}
# Filter for specific years and take a sample
scatter_data <- historical_prices %>%
  filter(year %in% c(2015, 2017, 2019, 2021, 2023, 2024)) %>%
  sample_n(600)

ggplot(scatter_data, aes(x = year, y = price, color = genre)) +
  geom_jitter(width = 0.3, height = 0, size = 3.5, alpha = 0.6) +
  
  scale_color_brewer(palette = "Set2") +
  
  scale_x_continuous(breaks = seq(2015, 2024, 1)) +
  scale_y_continuous(labels = dollar_format()) +
  
  labs(
    title = "Game Prices Over Time",
    x = "Year",
    y = "Price",
    color = "Genre"
  ) +
  
  theme_classic() +
  
  theme(
    text = element_text(size = 12),
    axis.text = element_text(color = "black"),
    legend.position = "right" 
  )
```

The scatter plot shows each genre's price trend over time. You can see the downward slopes for all genres, with Sports and RPG games staying higher up while Indie and Puzzle stay lower.

# Insights

Essentially genre matters a lot for how much games cost. Sports, RPG, and Action/FPS games are the most expensive (around $25-45) and Indie and Puzzle games are way cheaper at like $5-15. This makes sense because AAA games have bigger budgets.

All the genres showed prices going down from 2015 to 2024, usually dropping 30-50%. Indie games dropped the fastest, losing  50-60% of their value. Sports and Action games only dropped 20-30% which is due to franchises like FIFA and Call of Duty hold their value better than random indie titles that have to compete with more games

Summer and Winter sales on Steam bring prices down across the board for every genre. We expected this to show up in our data.

One other thing we noticed is that RPG and Action games have significantly more price variation than other genres. You have expensive AAA titles and cheap indie games both in those categories. Puzzle games are consistent price-wise.

Overall genre is the biggest factor in pricing but everything trends downward over time as games get older and there's more competition.
